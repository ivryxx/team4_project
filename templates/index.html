<!doctype html>
<html lang="en">
<head>

    <!-- Webpage Title -->
    <title>Home | 날씨야 뭐볼까?</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <!-- Font Awesome CSS -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='mystyle.css') }}" rel="stylesheet">

    <script>
        $(document).ready(function () {
            listing();
            show_weather();
        })

        function listing() {
            $.ajax({
                type: 'GET',
                url: '/movieData',
                data: {},
                success: function (response) {
                    let rows = response['movies']
                    console.log(rows)
                    for (let i = 0; i < rows.length; i++) {
                        let movieName = rows[i]['movieNm']
                        let movieImage = rows[i]['movieImg']
                        let movieScore = rows[i]['movieScr']
                        let movieJenre = rows[i]['movieJnr']

                        console.log(movieName, movieScore, movieJenre, movieImage)
                        let temp_html = `<li><img src="${movieImage}" style="width:170px; height:250px;"
                                             class="images" alt="..."></li>`
                        $('#movie').append(temp_html)
                    }
                }
            });
        }

        function show_weather() {

            $.ajax({
                type: "GET",
                url: "/weather",
                data: {},
                success: function (response) {
                    let rows = response['weather']
                    console.log(rows)

                    for (let i = rows.length - 1; i < rows.length; i++) {
                        let location = rows[i]['location']
                        let weather = rows[i]['weather']
                        // let temp_html = `<li>${weather}</li>`
                        let temperature = rows[i]['temperature']
                        let humidity = rows[i]['humidity']
                        let wind = rows[i]['wind']

                        let temp_html = `<li>
                            <p>위치 : ${location}</p>
                            <p>현재 날씨 : ${weather}</p>
                            <p>기온 : ${temperature}</p>
                            <p>습도 : ${humidity}</p>
                            <p>바람 : ${wind}</p>
                            </li>`
                        $('#weather').append(temp_html)

                    }
                }
            })
        }


    </script>

</head>
<body>

<nav class="navbar is-light" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <p class="title">날씨야 뭐볼래?! &nbsp;| </p>
        </a>
        <!-- 로그인하면 보이는 회원 이름 -->
        <a class="navbar-item">
            <p class="title3 user-name" id="user-name"><strong class="has-text-link">{{ user_id }}</strong> 님, 안녕하세요!
            </p>
        </a>
    </div>
</nav>

<div class="weather_info">
    <h1>날씨 정보입니다</h1>
    <ul id="weather"></ul>


</div>


<section class="section">
    <article class="media">
        <figure class="media-left" style="align-self: center">
            <a class="image is-32x32" href="/user/{{ user_info.username }}">
                <img class="is-rounded" src="{{ url_for('static', filename=user_info.profile_pic_real) }}">
            </a>
        </figure>
        <div class="media-content">
            <div class="field">
                <p class="control">
                    <input id="input-post" class="input is-rounded" placeholder="무슨 생각을 하고 계신가요?"
                           onclick='$("#modal-post").addClass("is-active")'></p>
            </div>
        </div>
    </article>
    <div class="modal" id="modal-post">
        <div class="modal-background" onclick='$("#modal-post").removeClass("is-active")'></div>
        <div class="modal-content">
            <div class="box">
                <article class="media">
                    <div class="media-content">
                        <div class="field">
                            <p class="control">
                                        <textarea id="textarea-post" class="textarea"
                                                  placeholder="무슨 생각을 하고 계신가요?"></textarea>
                            </p>
                        </div>
                        <nav class="level is-mobile">
                            <div class="level-left">

                            </div>
                            <div class="level-right">
                                <div class="level-item">
                                    <a class="button is-sparta" onclick="post()">포스팅하기</a>
                                </div>
                                <div class="level-item">
                                    <a class="button is-sparta is-outlined"
                                       onclick='$("#modal-post").removeClass("is-active")'>취소</a>
                                </div>
                            </div>
                        </nav>
                    </div>
                </article>
            </div>
        </div>
        <button class="modal-close is-large" aria-label="close"
                onclick='$("#modal-post").removeClass("is-active")'></button>
    </div>
</section>
    <div class="slide_wrapper">
    <div class="slides" id="movie">
    </div>
</div>
</div>

</div>
</section>
<footer class="footer mt-3">
    <div class="content has-text-centered">
        <p>
            <strong>hanghae99</strong> by <strong class="has-text-link-dark">4 TEAM</strong>
            &nbsp;| &nbsp;<strong class="has-text-link-dark">Project : </strong> 날씨야 뭐볼래?!
            &nbsp;| &nbsp;<strong class="has-text-link-dark">Dev.</strong> 김윤하, 김태균, 오경은, 오진우
        </p>
    </div>
</footer>

</body>
</html>